# Django Trunc(kind) and Extract(lookup_name) SQL Injection (CVE-2022-34265)

Django는 무엇인가?
Django는 빠른 개발과 깔끔하고 실용적인 설계를 장려하는 고급 Python 웹 프레임워크입니다.

보안 업데이트
Django는 2022년 7월 4일, Trunc()와 Extract() 데이터베이스 함수에서 발생하는 SQL 인젝션 취약점을 수정한 보안 업데이트를 발표했습니다.
이 취약점은 Django 4.0.6 미만, 3.2.14 미만 버전에 영향을 줍니다.

참고자료:

- https://www.djangoproject.com/weblog/2022/jul/04/security-releases/
- https://github.com/django/django/commit/0dc9c016fadb71a067e5a42be30164e3f96c0492

## 환경 설정

아래 명령어를 실행하여 취약한 Django 4.0.5 서버를 실행하세요:

```
docker compose up -d
```

서버가 실행되면, 웹 페이지에 접속할 수 있습니다: `http://your-ip:8000`.

## 취약점 재현 방법

웹 애플리케이션은 페이지 클릭 수를 집계하기 위해 Trunc 함수를 사용합니다.
http://your-ip:8000/?date=minute 에 접속하면 분 단위 클릭 수를 확인할 수 있습니다.

![](화햇 도커 과제1.png)

SQL 인젝션 공격
이제 date 파라미터에 악의적인 값을 넣어 SQL 인젝션을 시도합니다:

```
http://your-ip:8000/?date=xxxx'xxxx
```

요청을 보내면 SQL 에러 메시지가 출력되며, 인젝션이 성공했음을 확인할 수 있습니다.

![](화햇 도커 과제2.png)
